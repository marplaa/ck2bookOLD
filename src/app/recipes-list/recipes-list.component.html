

<div class="container">
  <div class="row">
    <div class="col-lg-12" style="padding: 10px 15px; height: 50px;">

      <button class="btn btn-success float-right" (click)="recipesService.save()">Speichern</button>
      <button class="btn btn-success float-right" (click)="recipesService.delete()">Löschen</button>
      <button class="btn btn-success float-right" (click)="render()">Rendern</button>


    </div>
  </div>
  <div class="row">
    <div class="col-12">
      <h2>Mein Kochbuch</h2>
    </div>
    <div class="col-lg-8">

      <div class="recipes-list-wrapper">
        <div class="tree">

        <ul>
          <ng-container *ngTemplateOutlet="recursiveListTmpl; context:{ recipes: recipes.children }"></ng-container>
        </ul>

        <ng-template #recursiveListTmpl let-list="recipes">
          <li *ngFor="let node of list">
            <!--
            is recipe or chapter?
            -->
            <ng-container *ngIf="isRecipe(node); else isChapter">
<!--              <a (click)="selectRecipe(node)">{{node.title}}</a>-->
              <a routerLink="/detail/{{node.id}}" (mouseover)="recipe=recipesService.getRecipeById(node.id)">{{node.title}}</a>

            </ng-container>
            <ng-template #isChapter>
              <a routerLink="/chapter/{{node.id}}">{{node.title}}</a>
              <div class="float-right">
                <button mat-icon-button (click)="openNewRecipeModal(newRecipeModal, node.id)">
                  <mat-icon>
                    note_add
                  </mat-icon>
                </button>
                <button mat-icon-button (click)="openNewChapterModal(newChapterModal, node.id)">
                  <mat-icon>
                    book
                  </mat-icon>
                </button>


              </div>



              <ul *ngIf="hasChild(node)">
                <ng-container *ngTemplateOutlet="recursiveListTmpl; context:{ recipes: node.children }"></ng-container>
              </ul>



            </ng-template>


          </li>
        </ng-template>

        </div>
      </div>
    </div>
    <div class="col-lg-4">
      <app-recipe-preview *ngIf="recipe" [recipe]="recipe"></app-recipe-preview>
    </div>
  </div>
  <div class="row">
    <div class="col-12">
      <mat-form-field class="example-full-width">
        <mat-label>Leave a comment</mat-label>
        <textarea matInput [(ngModel)]="renderOutput" placeholder="Ex. It makes me feel..."></textarea>
      </mat-form-field>
    </div>
  </div>

</div>


<ng-template #newChapterModal let-modal>
  <div class="modal-header">
    <h4 class="modal-title" id="modal-basic-title">Neues Kapitel unter "{{chapter.title}}" erstellen</h4>
    <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body">
    <form>
      <div class="form-group">
        <label for="newChapterTitle">Neues Kapitel</label>
        <div class="input-group">
          <input class="form-control" id="newChapterTitle" type="text" placeholder="Titel des neuen Kapitels" name="newChapterName" [(ngModel)]="newChapterTitle" style="margin-bottom: 10px">
        </div>
      </div>
    </form>
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-outline-dark" (click)="modal.close('s')">Save</button>
  </div>
</ng-template>

<ng-template #newRecipeModal let-modal>
  <div class="modal-header">
    <h4 class="modal-title" id="nr-title">Neues Rezept unter "{{chapter.title}}" hinzufügen</h4>
    <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body">
    <form>
      <div class="form-group">
        <label for="newChapterTitle">Neues Rezept</label>
        <div class="input-group">
          <input class="form-control" id="newRecipeUrl" type="text" placeholder="https://www.example.com" name="newRecipeUrl" [(ngModel)]="newRecipeUrl" style="margin-bottom: 10px">
        </div>
      </div>
    </form>
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-outline-dark" (click)="modal.close('s')">Save</button>
  </div>
</ng-template>


